import{_ as n,o as e,c as s,e as o}from"./app.31d0518d.js";const a={},t=o(`<h1 id="local-policy" tabindex="-1"><a class="header-anchor" href="#local-policy" aria-hidden="true">#</a> Local Policy</h1><p>Local policies can apply different configurations on a per-user basis. Each connection processed by V2Ray corresponds to a user, and overlapping policies are patched sequentially according to the policy&#39;s level.</p><h2 id="policyobject" tabindex="-1"><a class="header-anchor" href="#policyobject" aria-hidden="true">#</a> PolicyObject</h2><p><code>PolicyObject</code> corresponds to the <code>policy</code> element in the configuration file.</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;levels&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;0&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;handshake&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token property">&quot;connIdle&quot;</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
            <span class="token property">&quot;uplinkOnly&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token property">&quot;downlinkOnly&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token property">&quot;statsUserUplink&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">&quot;statsUserDownlink&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">&quot;bufferSize&quot;</span><span class="token operator">:</span> <span class="token number">10240</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;system&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;statsInboundUplink&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">&quot;statsInboundDownlink&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">&quot;statsOutboundUplink&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">&quot;statsOutboundDownlink&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>level</code>: map{string: <a href="#levelpolicyobject">LevelPolicyObject</a>}</p></blockquote><p>A set of key-value pairs, each key is a string in the form of a number (which meets JSON requirements), such as <code>&quot;0&quot;</code>, <code>&quot;1&quot;</code>, etc. Double quotes cannot be omitted. The key corresponds to the user level. The value is a <a href="#levelpolicyobject">LevelPolicyObject</a>.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>Both inbound and outbound proxies can now set a user level, and V2Ray will apply different local policies according to the effective user level.</p></div><blockquote><p><code>system</code>: <a href="#systempolicyobject">SystemPolicyObject</a></p></blockquote><p>V2Ray policy, see <a href="#SystemPolicyObject">SystemPolicyObject</a>.</p><h2 id="levelpolicyobject" tabindex="-1"><a class="header-anchor" href="#levelpolicyobject" aria-hidden="true">#</a> LevelPolicyObject</h2><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;handshake&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token property">&quot;connIdle&quot;</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
    <span class="token property">&quot;uplinkOnly&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;downlinkOnly&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token property">&quot;statsUserUplink&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;statsUserDownlink&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;bufferSize&quot;</span><span class="token operator">:</span> <span class="token number">10240</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>handshake</code>: number</p></blockquote><p>The timeout for finishing new connection handshakes, in seconds. The default value is <code>4</code>. When an inbound proxy processes a new connection, during the handshake stage (for example, when VMess reads the header data to determine the target server address), if the timeout is hit the connection will be reset.</p><blockquote><p><code>connIdle</code>: number</p></blockquote><p>The timeout for idle connections, in seconds. The default value is <code>300</code>. When an inbound or outbound handles a connection, if no data is transferred within <code>connIdle</code> time (including uplink and downlink data), the connection will be closed.</p><blockquote><p><code>uplinkOnly</code>: number</p></blockquote><p>The timeout after a downstream connection is closed, in seconds. The default value is <code>2</code>. When a server (such as the remote website) closes the downstream connection, an outbound will discard the connection after this timeout hits.</p><blockquote><p><code>downlinkOnly</code>: number</p></blockquote><p>The timeout after an upstream connection is closed, in seconds. The default value is <code>5</code>. When a client (such as the user&#39;s browser) closes the upstream connection, an outbound will discard the connection after this timeout hits.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>For HTTP browsing, <code>uplinkOnly</code> and <code>downlinkOnly</code> can be set to <code>0</code> to improve the efficiency of closing connections.</p></div><blockquote><p><code>statsUserUplink</code>: true | false</p></blockquote><p>When the value is set to<code>true</code>, enable uplink traffic statistics of all users at this level.</p><blockquote><p><code>statsUserDownlink</code>: true | false</p></blockquote><p>When the value is set to <code>true</code>, enable downlink traffic statistics of all users at this level.</p><blockquote><p><code>bufferSize</code>: number</p></blockquote><p>The size of the buffer used for each connection, in kB. When the value is set to <code>0</code>, the internal cache is disabled.</p><p>Default values depending on processor architecture, since v4.4:</p><ul><li>On ARM, MIPS, MIPSLE: <code>0</code>.</li><li>On ARM64, MIPS64, MIPS64LE: <code>4</code>.</li><li>On other platforms: <code>512</code>.</li></ul><p>v4.3 or older:</p><ul><li>On ARM, MIPS, MIPSLE, ARM64, MIPS64, MIPS64LE: <code>16</code>.</li><li>On other platforms: <code>2048</code>.</li></ul><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>The <code>bufferSize</code> option overrides the [environment variable](env.md#Cache size for each connection) <code>v2ray.ray.buffer.size</code>.</p></div><h2 id="systempolicyobject" tabindex="-1"><a class="header-anchor" href="#systempolicyobject" aria-hidden="true">#</a> SystemPolicyObject</h2><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;statsInboundUplink&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;statsInboundDownlink&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;statsOutboundUplink&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;statsOutboundDownlink&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>statsInboundUplink</code>: true | false</p></blockquote><p>When the value is set to <code>true</code>, enable uplink traffic statistics of all inbound proxies.</p><blockquote><p><code>statsInboundDownlink</code>: true | false</p></blockquote><p>When the value is set to <code>true</code>, enable downlink traffic statistics of all inbound proxies.</p><blockquote><p><code>statsOutboundUplink</code>: true | false</p></blockquote><p>(Since v4.26.0) When the value is set to <code>true</code>, enable uplink traffic statistics of all outbound proxies.</p><blockquote><p><code>statsOutboundDownlink</code>: true | false</p></blockquote><p>(Since v4.26.0) When the value is <code>true</code>, enable downlink traffic statistics of all outbound proxies.</p>`,42),c=[t];function l(p,i){return e(),s("div",null,c)}const r=n(a,[["render",l],["__file","policy.html.vue"]]);export{r as default};
